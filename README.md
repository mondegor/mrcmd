# Mrcmd Tool
Этот репозиторий содержит Mrcmd утилиту для группировки и запуска unix утилит, консольных скриптов и т.д.

## Статус проекта
Проект находится на стадии бета-тестирования.

## Описание проекта
Mrcmd - утилита, написанная на языке bash в строгой нотации. Её архитектура состоит из двух компонентов:
- ядра, которое можно использовать для написания собственных, более надёжных bash скриптов;
- системы управления небольшими утилитами — плагинами (SMP), предоставляющая общий интерфейс для их управления;

SMP каждому плагину позволяет решать собственную задачу, для этого предоставляет ему:
- независимое переменное окружение;
- возможность переопределения переменного окружения;
- реализацию групповых команд поддерживаемых утилитой, а также добавление своих собственных команд;
- настройку зависимостей от других плагинов;
- собственную справочную систему;

Тем самым, в каждом плагине скрывается способ решения той или иной задачи. Конкретный проект пользуется только общим интерфейсом утилиты и расширенными возможностями подключённых плагинов.

## Какие даёт возможности Mrcmd:
- быстрое локальное разворачивание проекта с использованием групповых команд, таких как install, start (на базе Docker);
- любой плагин можно подключить к нескольким проектам с изолированными настойками для каждого, они не будут пересекаться;
- реализация плагинов под конкретный проект со специфической функциональностью;
- возможность просмотра текущего переменного окружения всех плагинов для каждого проекта, выгрузка этого окружения в `.env.export`;
- централизованная система помощи вместе с общим дизайном команд помогут быстро разобраться как работает тот или иной плагин;
- встроенные инструменты для отладки утилиты, возможность просмотра текущего состояния утилиты (загруженные плагины, проблемы зависимостей);
- с помощью специального плагина имеется возможность подробной информации о каждом плагине (какие методы реализует, какие зависимости использует);
- на подобии make файла, можно описать персональные плагины, в которые будут убраны все вспомогательные, часто используемые команды используемые при разработке;
- создание интерфейсных команд, содержимое которых с течением времени меняется, например: создать бд, создать модель и т.д.;
- использование в качестве исследовательской деятельности, когда нужно быстро проверить ту или иную технологию с конкретными версиями;
- уменьшение сложности системы за счёт её распределения по плагинам, позволяющее быстро локализовывать и устранять проблемы;

## Опыт внедрения
Утилита была апробирована на нескольких проектах, в одном из которых используется микросервисная архитектура.
Для этого проекта было написано несколько плагинов:
- собирает из фрагментов общую API спецификацию и отдельно для каждого сервиса и сохраняет их в виде yaml файлов;
- собирает стенд, загружая сервисы проекта из различных репозиториев, инсталлирует их и запускает на машине разработчика;

## Команды Mrcmd
- `./mrcmd help` - помощь; 
- `./mrcmd state` - общее состояние утилиты;
- `./mrcmd config` - текущая конфигурация всех подключённых плагинов;
- `./mrcmd export-config` - выгрузка текущей конфигурации всех подключённых плагинов в `.env.export`;
- `./mrcmd install` - установка ресурсов тех плагинов, которые реализовали данную команду;
- `./mrcmd start` - запуск сервисов тех плагинов, которые реализовали данную команду;
- `./mrcmd stop` - остановка сервисов тех плагинов, которые реализовали данную команду;
- `./mrcmd uninstall` - удаление ресурсов тех плагинов, которые реализовали данную команду;

## Подключение плагинов к утилите
По умолчанию Mrcmd утилита не содержит в себе плагины, она от них вообще не зависит, но без них она совершенно бесполезна.
Чтобы установить для неё плагины, необходимо:
- распаковать в её директорию `./plugins` проект https://github.com/mondegor/mrcmd-plugins (необходимо учитывать версию);
- либо с помощью опции `--shared-plugins-dir DIR` указать местоположение необходимых плагинов;

## Вспомогательные проекты
- Базовый набор плагинов для утилиты: https://github.com/mondegor/mrcmd-plugins
- Утилита для тестирования bash скриптов: https://github.com/mondegor/mrtesh